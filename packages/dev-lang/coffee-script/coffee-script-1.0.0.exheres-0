# Copyright 2011 NAKAMURA Yoshitaka
# Distributed under the terms of the GNU General Public License v2

SUMMARY="CoffeeScript is a little language that compiles into JavaScript"
HOMEPAGE="http://jashkenas.github.com/coffee-script/"
DOWNLOADS="http://github.com/jashkenas/coffee-script/tarball/1.0.0 -> coffee-script-1.0.0.tar.gz"

LICENCES="MIT"
SLOT="0"
PLATFORMS="~amd64"

DEPENDENCIES="
    build:
    build+run:
        net-libs/nodejs
"

WORK="${WORKBASE}/jashkenas-coffee-script-33d2577"

DEFAULT_SRC_PREPARE_PATCHES=( -p1 "${FILES}/${PNV}-dont-link-to.patch" )

src_configure() {
    # do nothing
    :
}

src_compile() {
    ./bin/cake build
}

src_test() {
    ./bin/cake test
}

src_install() {
    ./bin/cake --prefix "${IMAGE}/usr" install

    doins /usr/bin
    dosym /usr/lib/coffee-script/bin/coffee /usr/bin/coffee
    dosym /usr/lib/coffee-script/bin/cake /usr/bin/cake
}

